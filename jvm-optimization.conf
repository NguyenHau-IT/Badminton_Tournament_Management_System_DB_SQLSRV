# JVM Optimization Configuration for BadmintonEventTechnology
# Sử dụng file này khi chạy ứng dụng để tối ưu hiệu suất

# Tăng heap size để xử lý nhiều sân cùng lúc
-Xms512m
-Xmx2g

# Tối ưu Garbage Collector
-XX:+UseG1GC
-XX:MaxGCPauseMillis=200
-XX:G1HeapRegionSize=16m
-XX:G1NewSizePercent=30
-XX:G1MaxNewSizePercent=40

# Tối ưu memory allocation
-XX:+UseStringDeduplication
-XX:+OptimizeStringConcat
-XX:+UseCompressedOops
-XX:+UseCompressedClassPointers

# Tối ưu thread và concurrency
-XX:ThreadStackSize=256k
-XX:+UseThreadPriorities
-XX:+UseBiasedLocking

# Tối ưu JIT compilation
-XX:+TieredCompilation
-XX:TieredStopAtLevel=1
-XX:+UseCodeCacheFlushing
-XX:CodeCacheMinimumFreeSpace=10m

# Tối ưu logging và monitoring
-XX:+PrintGC
-XX:+PrintGCDetails
-XX:+PrintGCTimeStamps
-XX:+PrintGCDateStamps
-Xloggc:gc.log

# Tối ưu network và I/O
-Djava.net.preferIPv4Stack=true
-Dsun.net.inetaddr.ttl=0
-Dsun.net.inetaddr.negative.ttl=0

# Tối ưu Swing/AWT
-Dsun.java2d.opengl=true
-Dsun.java2d.d3d=false
-Dsun.java2d.xrender=false
-Dawt.useSystemAAFontSettings=on

# Tối ưu reflection và dynamic proxy
-Dsun.misc.ProxyGenerator.saveGeneratedFiles=false
-Djdk.proxy.ProxyGenerator.saveGeneratedFiles=false

# Tối ưu security
-Djava.security.egd=file:/dev/./urandom

# Tối ưu timezone
-Duser.timezone=Asia/Ho_Chi_Minh

# Tối ưu file encoding
-Dfile.encoding=UTF-8
-Dsun.jnu.encoding=UTF-8

# Tối ưu performance monitoring
-XX:+UnlockCommercialFeatures
-XX:+FlightRecorder
-XX:StartFlightRecording=duration=60s,filename=badminton-app.jfr

# Tối ưu memory leak detection
-XX:+TraceClassLoading
-XX:+TraceClassUnloading

# Tối ưu startup time
-XX:+TieredCompilation
-XX:TieredStopAtLevel=1
-XX:+UseParallelGC

# Tối ưu cho nhiều sân
-Dspring.main.lazy-initialization=true
-Dspring.jpa.open-in-view=false
-Dserver.tomcat.threads.max=200
-Dserver.tomcat.threads.min-spare=20
-Dserver.tomcat.max-connections=8192
-Dserver.tomcat.accept-count=100

# Tối ưu database connection pool
-Dspring.datasource.hikari.maximum-pool-size=20
-Dspring.datasource.hikari.minimum-idle=5
-Dspring.datasource.hikari.connection-timeout=30000
-Dspring.datasource.hikari.idle-timeout=600000
-Dspring.datasource.hikari.max-lifetime=1800000

# Tối ưu cache
-Dspring.cache.type=caffeine
-Dspring.cache.caffeine.spec=maximumSize=1000,expireAfterWrite=300s

# Tối ưu logging
-Dlogging.level.root=WARN
-Dlogging.level.com.example.badmintoneventtechnology=INFO
-Dlogging.level.org.springframework.web=WARN
-Dlogging.level.org.hibernate=WARN

# Tối ưu metrics
-Dmanagement.endpoints.web.exposure.include=health,info,metrics
-Dmanagement.metrics.export.simple.enabled=false
