<!DOCTYPE html>
<html lang="vi" 
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    
    <!-- SEO Meta Tags -->
    <title th:text="${pageTitle != null ? pageTitle + ' - BTMS' : 'BTMS - Badminton Tournament Management System'}">BTMS - Hệ thống Quản lý Giải đấu Cầu lông</title>
    <meta name="description" th:content="${pageDescription != null ? pageDescription : 'Hệ thống quản lý giải đấu cầu lông chuyên nghiệp với real-time scoring và remote control'}">
    <meta name="keywords" content="cầu lông, badminton, quản lý giải đấu, tournament management, BTMS, scoreboard">
    <meta name="author" content="BTMS Team">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="http://localhost:2345">
    <meta property="og:title" th:content="${pageTitle != null ? pageTitle : 'BTMS - Badminton Tournament Management System'}">
    <meta property="og:description" th:content="${pageDescription != null ? pageDescription : 'Hệ thống quản lý giải đấu cầu lông chuyên nghiệp'}">
    <meta property="og:image" content="/images/og-image.jpg">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="http://localhost:2345">
    <meta property="twitter:title" th:content="${pageTitle != null ? pageTitle : 'BTMS'}">
    <meta property="twitter:description" th:content="${pageDescription != null ? pageDescription : 'Hệ thống quản lý giải đấu cầu lông chuyên nghiệp'}">
    
    <!-- Favicon -->
    <!-- <link rel="icon" type="image/x-icon" th:href="@{/favicon.ico}"> -->
    <!-- <link rel="apple-touch-icon" th:href="@{/apple-touch-icon.png}"> -->
    
    <!-- Bootstrap 5.3.3 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Montserrat:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    <!-- AOS (Animate On Scroll) Library -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.css">
    
    <!-- Swiper.js CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css">
    
    <!-- Common CSS - Load in correct order -->
    <link rel="stylesheet" th:href="@{/css/common/variables.css}">
    <link rel="stylesheet" th:href="@{/css/common/reset.css}">
    <link rel="stylesheet" th:href="@{/css/common/typography.css}">
    <link rel="stylesheet" th:href="@{/css/common/utilities.css}">
    
    <!-- Layout CSS - Load before page-specific -->
    <link rel="stylesheet" th:href="@{/css/layout/floating-header.css}">
    <link rel="stylesheet" th:href="@{/css/layouts/footer.css}">
    
    <!-- Page-specific CSS - Loaded last to allow overrides -->
    <th:block layout:fragment="css"></th:block>
    <th:block layout:fragment="page-css"></th:block>
    
    <!-- Critical inline CSS for immediate rendering -->
    <style>
        /* Prevent FOUC (Flash of Unstyled Content) */
        body { opacity: 0; }
        body.loaded { opacity: 1; transition: opacity 0.2s ease; }
        
        /* CRITICAL: Ensure floating header is CENTERED on ALL pages */
        .floating-header {
            position: fixed !important;
            top: 20px !important;
            left: 0 !important;
            right: 0 !important;
            margin: 0 auto !important;
            width: fit-content !important;
            max-width: 90% !important;
            z-index: 999999 !important;
            display: flex !important;
            justify-content: center !important;
            visibility: visible !important;
            opacity: 1 !important;
            pointer-events: auto !important;
        }
    </style>
</head>

<body data-theme="monochrome">
    <!-- Floating Header -->
    <div th:replace="~{fragments/floating-header :: floating-header}"></div>
    
    <!-- Main Content -->
    <main id="main-content" class="main-content">
        <div layout:fragment="content">
            <!-- Page content goes here -->
        </div>
    </main>
    
    <!-- Footer -->
    <div th:replace="~{layouts/footer :: footer}"></div>
    
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    
    <!-- Bootstrap 5.3.3 JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- AOS (Animate On Scroll) Library -->
    <script src="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.js"></script>
    <script>
        // Initialize AOS with enhanced configuration
        AOS.init({
            // Animation duration (ms)
            duration: 1000,          // Increased from 800 to 1000 for smoother effect
            
            // Easing function
            easing: 'ease-out-cubic', // Changed to cubic for more natural feel
            
            // Trigger once or every time scrolling
            once: true,              // Animate only once (better performance)
            
            // Offset from original trigger point (px)
            offset: 120,             // Increased from 100 to 120 for earlier trigger
            
            // Delay between animations (ms)
            delay: 0,                // No default delay (use data-aos-delay for specific elements)
            
            // Duration of delay (ms)
            anchorPlacement: 'top-bottom', // Element's top hits viewport's bottom
            
            // Disable on mobile (optional - set to false to keep animations)
            disable: false,          // Keep animations on all devices
            
            // Start with elements invisible
            startEvent: 'DOMContentLoaded',
            
            // Animation init class
            initClassName: 'aos-init',
            
            // Class applied after animation
            animatedClassName: 'aos-animate',
            
            // Use CSS3 transforms
            useClassNames: false,
            
            // Disable mutationObserver (better performance if you don't add elements dynamically)
            disableMutationObserver: false,
            
            // Debug mode
            debounceDelay: 50,       // Delay on resize events
            throttleDelay: 99        // Delay on scroll events
        });
        
        // Refresh AOS after dynamic content loaded (if needed)
        window.addEventListener('load', function() {
            AOS.refresh();
        });
    </script>
    
    <!-- Swiper.js JS -->
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
    
    <!-- Common JS -->
    <script th:src="@{/js/common/app.js}"></script>
    <script th:src="@{/js/common/utils.js}"></script>
    
    <!-- Floating Header JS -->
    <script th:src="@{/js/layout/floating-header.js}"></script>
    
    <!-- Page-specific JS -->
    <th:block layout:fragment="scripts"></th:block>
    <th:block layout:fragment="page-scripts"></th:block>
    
    <!-- Remove FOUC after everything loaded -->
    <script>
        // Show body immediately, don't wait for DOMContentLoaded
        document.body.classList.add('loaded');
        
        // Ensure floating header is visible
        document.addEventListener('DOMContentLoaded', function() {
            const header = document.querySelector('.floating-header');
            if (header) {
                console.log('Floating header found:', header);
                header.style.display = 'block';
                header.style.visibility = 'visible';
                header.style.opacity = '1';
                header.style.zIndex = '999999';
            } else {
                console.error('Floating header NOT found!');
            }
        });
    </script>
</body>
</html>
